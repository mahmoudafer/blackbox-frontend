{"version":3,"sources":["screens/Name/styles.module.css","../node_modules/peerjs/dist sync","screens/Home/styles.module.css","screens/Meeting/styles.module.css","screens/Home/index.js","screens/Name/index.js","screens/Meeting/index.js","App.js","index.js"],"names":["module","exports","webpackEmptyContext","req","e","Error","code","keys","resolve","id","Home","props","name","myPeer","setParentMeetingId","setMeetingId","useState","meetingId","email","setEmail","className","styles","container","title","row","input","onChange","target","value","placeholder","onClick","axios","post","peerID","headers","then","res","window","history","replaceState","data","catch","err","alert","classnames","joinBtn","activeBlue","length","console","log","status","message","Name","setName","_name","_setName","localStorage","setItem","Meeting","meetingID","userName","setUserName","recording","setRecording","otherPeerID","useRef","vid","audio","connection","canvasInterval","streamRef","mediaRecorder","recordedChunks","hangUp","useCallback","current","forEach","t","stop","close","useEffect","response","startRecording","canvas","document","getElementById","myVideo","hisVideo","myVideoDim","getBoundingClientRect","hisVideoDim","height","Math","max","width","audioContext","AudioContext","myVoice","createMediaStreamSource","MediaStream","hisVoice","voiceDestination","createMediaStreamDestination","connect","captureStream","MediaRecorder","getTracks","stream","mimeType","ondataavailable","event","size","push","download","start","blob","Blob","type","url","URL","createObjectURL","a","createElement","body","appendChild","style","href","click","revokeObjectURL","setInterval","getContext","drawImage","navigator","mediaDevices","getUserMedia","video","getAudioTracks","addVideoStream","on","call","answer","userVideoStream","find","i","connectToNewUser","userId","srcObject","addEventListener","play","videosContainer","autoPlay","muted","hangUpBtn","clearInterval","App","getItem","setMyPeer","location","pathname","match","myPeerRef","Peer","host","path","port","con","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.8a21f981.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__1UYJ6\",\"title\":\"styles_title__2Wp6F\",\"nextButton\":\"styles_nextButton__1NvjB\"};","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 30;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__qlI-2\",\"title\":\"styles_title__1gahL\",\"input\":\"styles_input__1Ewip\",\"joinBtn\":\"styles_joinBtn__1T4dU\",\"activeBlue\":\"styles_activeBlue__3TsNb\",\"row\":\"styles_row__NU_qs\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__91emN\",\"title\":\"styles_title__jMad3\",\"videosContainer\":\"styles_videosContainer__10nus\",\"video\":\"styles_video__2dhSk\",\"hangUpBtn\":\"styles_hangUpBtn__3hwR9\",\"canvas\":\"styles_canvas__r3lmI\"};","import React, { useState } from 'react'\r\nimport classnames from 'classnames'\r\nimport axios from 'axios'\r\n\r\nimport styles from './styles.module.css'\r\n\r\nconst Home = props => {\r\n    const { name, myPeer, setMeetingId: setParentMeetingId } = props\r\n    const [meetingId, setMeetingId] = useState()\r\n    const [email, setEmail] = useState()\r\n\r\n    const onChangeID = (e) => {\r\n        setMeetingId(e.target.value)\r\n    }\r\n\r\n    const onChangeEmail = (e) => {\r\n        setEmail(e.target.value)\r\n    }\r\n\r\n    const onJoin = () => {\r\n        axios(`https://backend-fjkv.onrender.com/meet/${meetingId}`)\r\n            .then(res => {\r\n                console.log(res)\r\n                if (res.status === 200) {\r\n                    window.history.replaceState(\"\", \"\", `https://backend-fjkv.onrender.com/meet/${meetingId}`)\r\n                    setParentMeetingId(meetingId)\r\n                }\r\n            })\r\n            .catch(err => alert(err.message))\r\n    }\r\n\r\n    const newMeeting = () => {\r\n        axios.post(`https://backend-fjkv.onrender.com/meet`, {\r\n            peerID: myPeer.id,\r\n            name,\r\n            email\r\n        },\r\n            {\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            }\r\n        ).then(res => {\r\n            window.history.replaceState(\"\", \"\", `https://backend-fjkv.onrender.com/meet/${res.data?.id}`)\r\n            setParentMeetingId(res.data?.id)\r\n        })\r\n            .catch(err => alert(err))\r\n    }\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <p className={styles.title}>Hello {name}!</p>\r\n            <div className={styles.row}>\r\n                <input className={styles.input} onChange={onChangeEmail} placeholder='Email to invite (Optional)' />\r\n                <button onClick={newMeeting}>New Meeting</button>\r\n            </div>\r\n            <div className={styles.row}>\r\n                <input className={styles.input} onChange={onChangeID} placeholder='Enter meeting id' />\r\n                <button className={classnames(styles.joinBtn, { [styles.activeBlue]: meetingId?.length })} onClick={onJoin}>Join</button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Home","import React, { useState } from 'react'\r\n\r\nimport styles from './styles.module.css'\r\n\r\nconst Name = props => {\r\n    const { setName } = props\r\n    const [_name, _setName] = useState()\r\n\r\n    const onChange = (e) => {\r\n        _setName(e.target?.value)\r\n    }\r\n\r\n    const save = () => {\r\n        setName(_name)\r\n        localStorage.setItem('name', _name)\r\n    }\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <p className={styles.title}>Hi! What's your name?</p>\r\n            <input onChange={onChange} placeholder='Your lovely name' />\r\n            <button onClick={save}>Go</button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Name","import React, { useRef, useEffect, useState, useCallback } from 'react'\r\nimport axios from 'axios'\r\n\r\nimport styles from './styles.module.css'\r\n\r\nconst Meeting = (props) => {\r\n    const { meetingID, myPeer, setMeetingId: setParentMeetingId } = props\r\n    const [userName, setUserName] = useState()\r\n    const [recording, setRecording] = useState()\r\n    const otherPeerID = useRef()\r\n    const vid = useRef()\r\n    const audio = useRef()\r\n    const connection = useRef()\r\n    const canvasInterval = useRef()\r\n    const streamRef = useRef()\r\n    const mediaRecorder = useRef()\r\n    const recordedChunks = useRef([])\r\n\r\n    const hangUp = useCallback(() => {\r\n        window.history.replaceState(\"\", \"\", 'https://blackbox-frontend.onrender.com/')\r\n        setParentMeetingId(null)\r\n        vid.current?.forEach(t => t.stop())\r\n        connection.current?.close()\r\n    }, [setParentMeetingId])\r\n\r\n    useEffect(() => {\r\n        axios(`https://backend-fjkv.onrender.com/meet/${meetingID}`)\r\n            .then(res => {\r\n                setUserName(res.data?.name)\r\n                otherPeerID.current = res.data?.peerID\r\n            })\r\n            .catch(err => {\r\n                if (err.response.status == 404)\r\n                    alert('Invalid meeting ID')\r\n                // window.history.replaceState(\"\", \"\", 'http://192.168.31.246:3000')\r\n                // setParentMeetingId(null)\r\n                // hangUp()\r\n            })\r\n    }, [meetingID, setParentMeetingId])\r\n\r\n    const startRecording = useCallback(() => {\r\n        setRecording(true)\r\n        const fps = 30\r\n        const canvas = document.getElementById('recording-canvas')\r\n        const myVideo = document.getElementById('my-video')\r\n        const hisVideo = document.getElementById('his-video')\r\n\r\n        const myVideoDim = myVideo.getBoundingClientRect()\r\n        const hisVideoDim = hisVideo.getBoundingClientRect()\r\n\r\n        canvas.height = Math.max(myVideoDim.height, hisVideoDim.height)\r\n        canvas.width = myVideoDim.width + hisVideoDim.width\r\n\r\n        const drawImage = () => {\r\n            canvas.getContext('2d').drawImage(myVideo, 0, 0, 100, 100)\r\n            canvas.getContext('2d').drawImage(myVideo, 0, 0, myVideoDim.width, myVideoDim.height)\r\n            canvas.getContext('2d').drawImage(hisVideo, myVideoDim.width, 0, hisVideoDim.width, hisVideoDim.height)\r\n        }\r\n\r\n        const audioContext = new AudioContext()\r\n        console.log(audio.current)\r\n        const myVoice = audioContext.createMediaStreamSource(new MediaStream([audio.current[0]]))\r\n        const hisVoice = audioContext.createMediaStreamSource(new MediaStream([audio.current[1]]))\r\n        const voiceDestination = audioContext.createMediaStreamDestination()\r\n        myVoice.connect(voiceDestination)\r\n        hisVoice.connect(voiceDestination)\r\n\r\n        streamRef.current = canvas.captureStream(fps)\r\n\r\n        mediaRecorder.current = new MediaRecorder(new MediaStream([...streamRef.current.getTracks(), ...voiceDestination.stream.getTracks()]), { mimeType: 'video/webm' })\r\n        mediaRecorder.current.ondataavailable = (event) => {\r\n            if (event.data?.size > 0) {\r\n                recordedChunks.current.push(event.data)\r\n                download()\r\n            }\r\n        }\r\n        mediaRecorder.current.start()\r\n\r\n        const download = () => {\r\n            const blob = new Blob(recordedChunks.current, {\r\n                type: 'video/webm'\r\n            })\r\n            const url = URL.createObjectURL(blob)\r\n            const a = document.createElement('a')\r\n            document.body.appendChild(a)\r\n            a.style = 'display: none'\r\n            a.href = url\r\n            a.download = 'recording.webm'\r\n            a.click()\r\n            window.URL.revokeObjectURL(url)\r\n            recordedChunks.current = []\r\n        }\r\n\r\n        canvasInterval.current = setInterval(() => {\r\n            drawImage()\r\n        }, 1000 / fps)\r\n    }, [])\r\n\r\n    const stopRecording = () => {\r\n        setRecording(false)\r\n        clearInterval(canvasInterval.current)\r\n        mediaRecorder.current?.stop();\r\n    }\r\n\r\n    useEffect(() => {\r\n        const myVideo = document.getElementById('my-video')\r\n        const hisVideo = document.getElementById('his-video')\r\n        navigator.mediaDevices.getUserMedia({\r\n            video: true,\r\n            audio: true\r\n        }).then(stream => {\r\n            vid.current = stream?.getTracks()\r\n            audio.current = stream?.getAudioTracks()\r\n            addVideoStream(myVideo, stream)\r\n\r\n            myPeer?.on('call', call => {\r\n                connection.current = call\r\n                call.answer(stream)\r\n                // const video = document.createElement('video')\r\n                call.on('stream', userVideoStream => {\r\n                    if (!audio.current.find(i => i.id === userVideoStream.getAudioTracks()[0]?.id))\r\n                        audio.current = [...audio.current, ...userVideoStream.getAudioTracks()]\r\n                    addVideoStream(hisVideo, userVideoStream)\r\n                })\r\n                call.on('close', hangUp)\r\n            })\r\n            if (myPeer.id !== otherPeerID.current) {\r\n                connectToNewUser(otherPeerID.current, stream)\r\n            }\r\n        })\r\n            .catch(console.log)\r\n\r\n        const connectToNewUser = (userId, stream) => {\r\n            const call = myPeer.call(userId, stream)\r\n            call.on('stream', userVideoStream => {\r\n                if (!audio.current.find(i => i.id === userVideoStream.getAudioTracks()[0]?.id))\r\n                    audio.current = [...audio.current, ...userVideoStream.getAudioTracks()]\r\n                addVideoStream(hisVideo, userVideoStream)\r\n            })\r\n            call.on('close', hangUp)\r\n            connection.current = call\r\n        }\r\n\r\n        const addVideoStream = (video, stream) => {\r\n            video.srcObject = stream\r\n            video.addEventListener('loadedmetadata', () => {\r\n                video.play()\r\n            })\r\n        }\r\n    }, [myPeer, hangUp])\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <p className={styles.title}>Meeting with {userName}</p>\r\n            <div className={styles.videosContainer}>\r\n                <div className={styles.video}>\r\n                    <video autoPlay id='my-video' muted>\r\n                        Your browser does not support the video tag.\r\n                </video>\r\n                </div>\r\n                <div className={styles.video}>\r\n                    <video autoPlay id='his-video'>\r\n                        Your browser does not support the video tag.\r\n                </video>\r\n                </div>\r\n            </div>\r\n            <canvas className={styles.canvas} id='recording-canvas'></canvas>\r\n            <button className={styles.hangUpBtn} onClick={hangUp}>Hang Up</button>\r\n            <button onClick={recording ? stopRecording : startRecording}>{recording ? \"Stop Recording\" : \"Start Recording\"}</button>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default Meeting","import React, { useEffect, useRef, useState } from 'react'\nimport Peer from 'peerjs'\n\nimport styles from './App.module.css'\nimport { Home, Name, Meeting } from './screens'\n\nconst App = () => {\n  const [meetingID, setMeetingId] = useState()\n  const [name, setName] = useState(localStorage.getItem('name'))\n  const [myPeer, setMyPeer] = useState()\n\n  const id = window.location?.pathname?.match(/(?<=\\/meet\\/)()\\d+$/gm)\n  if (id?.length && id[0] != meetingID)\n    setMeetingId(id)\n\n  const myPeerRef = useRef(new Peer({\n    host: 'https://backend-fjkv.onrender.com',\n    path: 'peer',\n    port: '3001'\n  }))\n  myPeerRef.current.on('open', con => {\n    setMyPeer(myPeerRef.current)\n  })\n\n  // myPeer.current?.on('open', id => {\n  //   setPeerID(id)\n  //   console.log('peer opened')\n  // })\n\n  return (\n    <div style={styles.container}>\n      {meetingID ?\n        // <Meeting myPeer={myPeer.current} meetingID={meetingID} peerID={peerID} />\n        <Meeting myPeer={myPeer} meetingID={meetingID} setMeetingId={setMeetingId} />\n        : name ?\n          <Home name={name} myPeer={myPeer} setMeetingId={setMeetingId} />\n          // <Home name={name} peerID={peerID} />\n          : <Name setName={setName} />\n      }\n    </div>\n  )\n}\n\nexport default App","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}